% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\AtBeginSection[]{\begin{frame}\tableofcontents[currentsection]\end{frame}}
\AtBeginSubsection[]{\begin{frame}\tableofcontents[currentsubsection]\end{frame}{}}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={The Collapse of the American Dream: From Rags to Riches to The Ragged and The Rich},
  pdfauthor={John Wu; Connie Lu; Smriti Vijay; Gwyneth Gao; Alvin Li},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{The Collapse of the American Dream: \emph{From Rags to Riches to
The Ragged and The Rich}}
\author{John Wu \and Connie Lu \and Smriti Vijay \and Gwyneth
Gao \and Alvin Li}
\date{}

\begin{document}
\maketitle

\section{EDA}\label{eda}

\subsection{Importing All Excel
Sheets}\label{importing-all-excel-sheets}

\begin{verbatim}
## New names:
## New names:
## * `` -> `...3`
## * `` -> `...4`
\end{verbatim}

\subsection{JOINING DATA}\label{joining-data}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{country\_data }\OtherTok{\textless{}{-}}\NormalTok{ (mobility\_index }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(health\_index, }\AttributeTok{by =} \StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(education\_index, }\AttributeTok{by =} \StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(top\_1\_share\_country, }\AttributeTok{by =} \StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(welfare\_country, }\AttributeTok{by =}\StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(gini\_country, }\AttributeTok{by =} \StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(country\_tuition, }\AttributeTok{by =} \StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(house\_affordability\_country, }\AttributeTok{by =} \StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(corruption\_index, }\AttributeTok{by =} \StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(universal\_healthcare, }\AttributeTok{by=}\StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(GDP\_country, }\AttributeTok{by=}\StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(poverty\_rate, }\AttributeTok{by=}\StringTok{\textquotesingle{}Country\textquotesingle{}}\NormalTok{))[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{82}\NormalTok{,]}


\NormalTok{country\_data }\OtherTok{\textless{}{-}}\NormalTok{ country\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Universal Healthcare}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Universal Healthcare}\StringTok{\textasciigrave{}}\NormalTok{), }\StringTok{\textquotesingle{}No\textquotesingle{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{Universal Healthcare}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Universal Healthcare}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{factor}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Universal Healthcare}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{ifelse}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}} \SpecialCharTok{==} \DecValTok{1}\NormalTok{, }\StringTok{\textquotesingle{}Yes\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}No\textquotesingle{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{factor}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{GDP)}

\NormalTok{refined\_country\_data }\OtherTok{\textless{}{-}}\NormalTok{ country\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Universal Healthcare}\StringTok{\textasciigrave{}}\NormalTok{, }\SpecialCharTok{{-}}\NormalTok{ Country, }\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Tuition Fees in USD Thousands less 0}\StringTok{\textasciigrave{}}\NormalTok{)}


\NormalTok{expenditures }\OtherTok{\textless{}{-}}\NormalTok{ medicare\_prem }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(house\_price\_us, }\AttributeTok{by =} \StringTok{\textquotesingle{}Year\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(tuition\_us, }\AttributeTok{by =} \StringTok{\textquotesingle{}Year\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(med\_income\_us, }\AttributeTok{by =} \StringTok{\textquotesingle{}Year\textquotesingle{}}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Year}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{Healthcare Premium Index}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{House Price Index}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{Tuition Index}\StringTok{\textasciigrave{}}\NormalTok{, }\StringTok{\textasciigrave{}}\AttributeTok{Median Income Index}\StringTok{\textasciigrave{}}\NormalTok{)}

\NormalTok{expenditures\_data\_long }\OtherTok{\textless{}{-}}\NormalTok{ expenditures }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols=} \SpecialCharTok{{-}}\NormalTok{ Year, }\AttributeTok{names\_to =}\StringTok{\textquotesingle{}Expenditures\textquotesingle{}}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{\textquotesingle{}Values\textquotesingle{}}\NormalTok{)}


\NormalTok{surpass\_data\_long }\OtherTok{\textless{}{-}}\NormalTok{ child\_surpass\_us }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \SpecialCharTok{{-}}\NormalTok{ Year, }\AttributeTok{names\_to =} \StringTok{"Groups"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"Percent"}\NormalTok{)}

\NormalTok{wealth\_share\_long }\OtherTok{\textless{}{-}}\NormalTok{ wealth\_share\_us }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols=} \SpecialCharTok{{-}}\NormalTok{Year, }\AttributeTok{names\_to =} \StringTok{\textquotesingle{}Groups\textquotesingle{}}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{\textquotesingle{}Percent\textquotesingle{}}\NormalTok{)}

\NormalTok{fituniversal }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Universal Healthcare}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}}\NormalTok{, country\_data)}
\FunctionTok{summary}\NormalTok{(fituniversal)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `Social Mobility Index` ~ `Universal Healthcare` + 
##     `Affordable Housing`, data = country_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -28.3932  -4.5072   0.0048   6.6713  20.1928 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                 54.507      1.553  35.088  < 2e-16 ***
## `Universal Healthcare`Yes    6.302      2.244   2.808  0.00643 ** 
## `Affordable Housing`Yes     15.286      2.194   6.966 1.36e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 9.011 on 71 degrees of freedom
##   (8 observations deleted due to missingness)
## Multiple R-squared:  0.5112, Adjusted R-squared:  0.4974 
## F-statistic: 37.12 on 2 and 71 DF,  p-value: 9.236e-12
\end{verbatim}

\subsection{Visualizing}\label{visualizing}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(expenditures\_data\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Year, }\AttributeTok{y=}\NormalTok{Values, }\AttributeTok{col=}\NormalTok{Expenditures)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 27 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-4-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(surpass\_data\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Year, }\AttributeTok{y=}\NormalTok{ Percent, }\AttributeTok{col =}\NormalTok{ Groups)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-4-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(gini\_us, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Year, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Gini Coefficient}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
   \FunctionTok{geom\_rect}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xmin =} \DecValTok{1980} \SpecialCharTok{{-}} \FloatTok{0.5}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{1980} \SpecialCharTok{+} \DecValTok{9}\NormalTok{, }\AttributeTok{ymin =} \SpecialCharTok{{-}}\ConstantTok{Inf}\NormalTok{, }\AttributeTok{ymax =} \ConstantTok{Inf}\NormalTok{),}
            \AttributeTok{fill =} \StringTok{"grey80"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{1980}\NormalTok{, }\AttributeTok{y =} \FunctionTok{max}\NormalTok{(country\_data}\SpecialCharTok{$}\NormalTok{Value) }\SpecialCharTok{*} \FloatTok{0.9}\NormalTok{, }
           \AttributeTok{label =} \StringTok{"Reaganomics Implementation"}\NormalTok{, }\AttributeTok{angle =} \DecValTok{0}\NormalTok{, }\AttributeTok{vjust =} \SpecialCharTok{{-}}\DecValTok{30}\NormalTok{, }\AttributeTok{hjust =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
   \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Unknown or uninitialised column: `Value`.
\end{verbatim}

\begin{verbatim}
## Warning in max(country_data$Value): no non-missing arguments to max; returning
## -Inf
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-4-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(wealth\_share\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{Year, }\AttributeTok{y=}\NormalTok{Percent)) }\SpecialCharTok{+}
   \FunctionTok{geom\_rect}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xmin =} \DecValTok{1980} \SpecialCharTok{{-}} \FloatTok{0.5}\NormalTok{, }\AttributeTok{xmax =} \DecValTok{1980} \SpecialCharTok{+} \DecValTok{9}\NormalTok{, }\AttributeTok{ymin =} \SpecialCharTok{{-}}\ConstantTok{Inf}\NormalTok{, }\AttributeTok{ymax =} \ConstantTok{Inf}\NormalTok{),}
            \AttributeTok{fill =} \StringTok{"grey80"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \DecValTok{1980}\NormalTok{, }\AttributeTok{y =} \FunctionTok{max}\NormalTok{(country\_data}\SpecialCharTok{$}\NormalTok{Value) }\SpecialCharTok{*} \FloatTok{0.9}\NormalTok{, }
           \AttributeTok{label =} \StringTok{"Reaganomics Implementation"}\NormalTok{, }\AttributeTok{angle =} \DecValTok{0}\NormalTok{, }\AttributeTok{vjust =} \SpecialCharTok{{-}}\DecValTok{15}\NormalTok{, }\AttributeTok{hjust =} \SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{col=}\NormalTok{Groups),}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Unknown or uninitialised column: `Value`.
## no non-missing arguments to max; returning -Inf
\end{verbatim}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-4-4.pdf}

\subsection{PLOTTING}\label{plotting}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(country\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Country          Social Mobility Index Health Care Index
##  Length:82          Min.   :34.50         Min.   :42.20    
##  Class :character   1st Qu.:51.70         1st Qu.:58.88    
##  Mode  :character   Median :63.45         Median :67.50    
##                     Mean   :62.21         Mean   :65.73    
##                     3rd Qu.:74.38         3rd Qu.:72.65    
##                     Max.   :85.20         Max.   :83.00    
##                                           NA's   :10       
##  Health Expenditure Index Education Index  Wealth Share Top 1%
##  Min.   : 72.1            Min.   :0.3500   Min.   :0.0690     
##  1st Qu.:104.8            1st Qu.:0.7000   1st Qu.:0.1030     
##  Median :122.2            Median :0.8200   Median :0.1360     
##  Mean   :118.5            Mean   :0.7833   Mean   :0.1423     
##  3rd Qu.:133.6            3rd Qu.:0.8900   3rd Qu.:0.1862     
##  Max.   :151.9            Max.   :1.0100   Max.   :0.2680     
##  NA's   :10               NA's   :1        NA's   :2          
##  Welfare Spending % GDP Gini Coefficient Tuition Fees in USD Thousands less 0
##  Min.   :10.90          Min.   :0.2300   Min.   : 0.02727                    
##  1st Qu.:16.20          1st Qu.:0.3050   1st Qu.: 1.13097                    
##  Median :19.15          Median :0.3500   Median : 3.18239                    
##  Mean   :20.25          Mean   :0.3593   Mean   : 4.56606                    
##  3rd Qu.:24.02          3rd Qu.:0.4000   3rd Qu.: 6.14517                    
##  Max.   :31.20          Max.   :0.6300   Max.   :30.78523                    
##  NA's   :46             NA's   :7        NA's   :44                          
##  Housing Affordability Index Mortgage as a % of Income Price to Income Ratio
##  Min.   :0.100               Min.   : 0.2180           Min.   : 2.900       
##  1st Qu.:0.625               1st Qu.: 0.6458           1st Qu.: 9.125       
##  Median :1.000               Median : 1.0225           Median :11.300       
##  Mean   :1.149               Mean   : 1.4521           Mean   :13.091       
##  3rd Qu.:1.575               3rd Qu.: 1.6740           3rd Qu.:14.575       
##  Max.   :4.600               Max.   :11.3520           Max.   :41.700       
##  NA's   :8                   NA's   :8                 NA's   :8            
##  Affordable Housing Corruption Perception Universal Healthcare      Rank       
##  No  :39            Min.   :23.00         No :52               Min.   :  1.00  
##  Yes :35            1st Qu.:36.00         Yes:30               1st Qu.: 20.75  
##  NA's: 8            Median :49.50                              Median : 44.50  
##                     Mean   :51.99                              Mean   : 51.20  
##                     3rd Qu.:71.00                              3rd Qu.: 78.25  
##                     Max.   :90.00                              Max.   :131.00  
##                     NA's   :2                                  NA's   :2       
##  GDP Per Capita   % of World GDP     Poverty Rate  
##  Min.   :  1588   Min.   :0.00010   Min.   : 6.70  
##  1st Qu.:  6332   1st Qu.:0.00070   1st Qu.: 8.80  
##  Median : 15418   Median :0.00300   Median :10.00  
##  Mean   : 26485   Mean   :0.01167   Mean   :11.53  
##  3rd Qu.: 36367   3rd Qu.:0.00710   3rd Qu.:14.40  
##  Max.   :127046   Max.   :0.25320   Max.   :20.30  
##  NA's   :2        NA's   :2         NA's   :57
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(country\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 82 19
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Country, }\AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{color =} \StringTok{\textquotesingle{}lightblue\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Plot points}
  \FunctionTok{geom\_label\_repel}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ Country), }\AttributeTok{size =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}  \CommentTok{\# Add labels with automatic adjustment}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_blank}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 1 row containing missing values or values outside the scale range
## (`geom_point()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 row containing missing values or values outside the scale range
## (`geom_label_repel()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Testing for Correlation}


\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 1 row containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Gini Coefficient}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 7 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Health Care Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 10 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Health Expenditure Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 10 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Wealth Share Top 1\%}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-6.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Welfare Spending \% GDP}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 46 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-7.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Tuition Fees in USD Thousands less 0}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 44 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-8.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Housing Affordability Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 8 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-9.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Mortgage as a \% of Income}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 8 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-10.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Price to Income Ratio}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 8 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-11.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Corruption Perception}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-12.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =} \FunctionTok{factor}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method=} \StringTok{\textquotesingle{}glm\textquotesingle{}}\NormalTok{, }\AttributeTok{method.args =} \FunctionTok{list}\NormalTok{(}\AttributeTok{family =} \StringTok{\textquotesingle{}binomial\textquotesingle{}}\NormalTok{), }\AttributeTok{se =}\NormalTok{ F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using formula = 'y ~ x'
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-13.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 57 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-14.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Gini Coefficient}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 57 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-15.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 57 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-16.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-17.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 3 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-18.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Housing Affordability Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 57 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-19.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Mortgage as a \% of Income}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 57 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-20.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 57 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-21.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Gini Coefficient}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 8 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-22.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Welfare Spending \% GDP}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 47 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-23.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(refined\_country\_data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Health Care Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 11 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-5-24.pdf}

\section{Data Preparation}\label{data-preparation}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\NormalTok{refined\_country\_data }\OtherTok{\textless{}{-}}\NormalTok{ refined\_country\_data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{/} \DecValTok{1000}\NormalTok{)}

\NormalTok{no\_na }\OtherTok{\textless{}{-}}\NormalTok{ refined\_country\_data[}\FunctionTok{complete.cases}\NormalTok{(refined\_country\_data), ] }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Rank) }



\NormalTok{testing\_indices2 }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\FunctionTok{nrow}\NormalTok{(no\_na), }\DecValTok{5}\NormalTok{)}

\NormalTok{c.data.test2 }\OtherTok{\textless{}{-}}\NormalTok{ no\_na[testing\_indices2, ]}

\NormalTok{no\_na.notest }\OtherTok{\textless{}{-}}\NormalTok{ no\_na[}\SpecialCharTok{{-}}\NormalTok{testing\_indices2,]}
\NormalTok{no\_na.notest }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.notest }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}}\NormalTok{) }
\NormalTok{no\_na.test }\OtherTok{\textless{}{-}}\NormalTok{ no\_na[testing\_indices2, ] }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}}\NormalTok{)}

\NormalTok{test\_rows }\OtherTok{\textless{}{-}} \FunctionTok{which}\NormalTok{(}\FunctionTok{row.names}\NormalTok{(refined\_country\_data) }\SpecialCharTok{\%in\%} \FunctionTok{row.names}\NormalTok{(c.data.test2))}

\NormalTok{c.data.notest2 }\OtherTok{\textless{}{-}}\NormalTok{ refined\_country\_data[}\SpecialCharTok{{-}}\NormalTok{test\_rows, ] }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Rank)}
\end{Highlighting}
\end{Shaded}

\section{Data Analysis}\label{data-analysis}

\subsection{LM, LASSO, \& RELAXED LASSO}\label{lm-lasso-relaxed-lasso}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predictors }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.notest }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{predictors }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data=}\NormalTok{predictors)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# force\_in\_education \textless{}{-} ifelse(grepl(\textquotesingle{}Education Index\textquotesingle{}, colnames(predictors)), 0, 1)}
\CommentTok{\# }
\CommentTok{\# lasso\_education\_smi\_ed \textless{}{-} cv.glmnet(predictors, no\_na.notest$\textasciigrave{}Social Mobility Index\textasciigrave{}, alpha=1, penalty.factor = force\_in\_education)}
\CommentTok{\# }
\CommentTok{\# coef(lasso\_education\_smi\_ed, s=\textquotesingle{}lambda.min\textquotesingle{})}
\CommentTok{\# }
\CommentTok{\# relaxed\_lasso\_smi\_ed \textless{}{-} lm(\textasciigrave{}Social Mobility Index\textasciigrave{} \textasciitilde{} \textasciigrave{}Health Expenditure Index\textasciigrave{} + \textasciigrave{}Education Index\textasciigrave{} + \textasciigrave{}Welfare Spending \% GDP\textasciigrave{} + \textasciigrave{}Gini Coefficient\textasciigrave{} + \textasciigrave{}Housing Affordability Index\textasciigrave{} + \textasciigrave{}Corruption Perception\textasciigrave{} + \textasciigrave{}GDP Per Capita\textasciigrave{} + \textasciigrave{}Poverty Rate\textasciigrave{}, data=c.data.notest2)}
\CommentTok{\# summary(relaxed\_lasso\_smi\_ed)}

\NormalTok{lasso\_smi }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(predictors, no\_na.notest}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{alpha=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Option grouped=FALSE enforced in cv.glmnet, since < 3 observations per
## fold
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(lasso\_smi, }\AttributeTok{s=} \StringTok{\textquotesingle{}lambda.min\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 14 x 1 sparse Matrix of class "dgCMatrix"
##                                          s1
## (Intercept)                    56.590189780
## `Health Care Index`             .          
## `Health Expenditure Index`      0.075570171
## `Education Index`               .          
## `Wealth Share Top 1%`         -12.521226645
## `Welfare Spending % GDP`        .          
## `Gini Coefficient`            -33.001600195
## `Housing Affordability Index`   .          
## `Mortgage as a % of Income`     .          
## `Price to Income Ratio`         .          
## `Corruption Perception`         0.329817028
## `GDP Per Capita`                0.003832561
## `% of World GDP`                .          
## `Poverty Rate`                 -0.216654169
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{relaxed\_lasso\_smi }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Health Expenditure Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Wealth Share Top 1\%}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Gini Coefficient}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Corruption Perception}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{, c.data.notest2)}
\FunctionTok{summary}\NormalTok{(relaxed\_lasso\_smi)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `Social Mobility Index` ~ `Health Expenditure Index` + 
##     `Wealth Share Top 1%` + `Gini Coefficient` + `Corruption Perception` + 
##     `GDP Per Capita` + `Poverty Rate`, data = c.data.notest2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.7632 -0.9120 -0.0604  0.6667  3.0218 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                 52.42909    5.60903   9.347 1.21e-07 ***
## `Health Expenditure Index`   0.10324    0.03895   2.650  0.01818 *  
## `Wealth Share Top 1%`      -15.72387   19.93255  -0.789  0.44249    
## `Gini Coefficient`         -20.25784   15.31682  -1.323  0.20578    
## `Corruption Perception`      0.31401    0.08269   3.798  0.00175 ** 
## `GDP Per Capita`             0.01606    0.02543   0.632  0.53711    
## `Poverty Rate`              -0.45275    0.21779  -2.079  0.05521 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.945 on 15 degrees of freedom
##   (55 observations deleted due to missingness)
## Multiple R-squared:  0.9239, Adjusted R-squared:  0.8935 
## F-statistic: 30.36 on 6 and 15 DF,  p-value: 1.431e-07
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm\_smi }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+}\StringTok{\textasciigrave{}}\AttributeTok{Wealth Share Top 1\%}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Welfare Spending \% GDP}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Corruption Perception}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Health Care Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Housing Affordability Index}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data=}\NormalTok{refined\_country\_data)}
\FunctionTok{summary}\NormalTok{(lm\_smi)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `Social Mobility Index` ~ `Education Index` + `Wealth Share Top 1%` + 
##     `Welfare Spending % GDP` + `Corruption Perception` + `Health Care Index` + 
##     `Housing Affordability Index`, data = refined_country_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.8843 -2.0893  0.5847  1.4304  5.0994 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                    31.12478    9.67961   3.215  0.00327 ** 
## `Education Index`              16.78308    9.48034   1.770  0.08757 .  
## `Wealth Share Top 1%`         -70.33036   14.78501  -4.757 5.39e-05 ***
## `Welfare Spending % GDP`        0.20041    0.11620   1.725  0.09562 .  
## `Corruption Perception`         0.38582    0.06572   5.870 2.60e-06 ***
## `Health Care Index`             0.04596    0.07982   0.576  0.56935    
## `Housing Affordability Index`   1.55567    1.38638   1.122  0.27135    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.116 on 28 degrees of freedom
##   (47 observations deleted due to missingness)
## Multiple R-squared:  0.9061, Adjusted R-squared:  0.886 
## F-statistic: 45.04 on 6 and 28 DF,  p-value: 4.124e-13
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# POVERTY}

\NormalTok{predictorspov }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.notest }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{predictorspov }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data=}\NormalTok{predictorspov)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}

\NormalTok{force\_in\_education\_pov }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{grepl}\NormalTok{(}\StringTok{\textquotesingle{}Education Index\textquotesingle{}}\NormalTok{, }\FunctionTok{colnames}\NormalTok{(predictorspov)), }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\NormalTok{lasso\_pov }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(predictorspov, no\_na.notest}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{alpha=}\DecValTok{1}\NormalTok{, }\AttributeTok{penalty.factor =}\NormalTok{ force\_in\_education\_pov)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Option grouped=FALSE enforced in cv.glmnet, since < 3 observations per
## fold
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# lasso\_pov\_noed \textless{}{-} cv.glmnet(predictorspov, no\_na.notest$\textasciigrave{}Poverty Rate\textasciigrave{}, alpha=1)}
\CommentTok{\# coef(lasso\_pov\_noed)}

\FunctionTok{coef}\NormalTok{(lasso\_pov, }\AttributeTok{s=}\StringTok{\textquotesingle{}lambda.min\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 14 x 1 sparse Matrix of class "dgCMatrix"
##                                        s1
## (Intercept)                   -3.11115297
## `Social Mobility Index`        .         
## `Health Care Index`            .         
## `Health Expenditure Index`     .         
## `Education Index`              1.38089256
## `Wealth Share Top 1%`          .         
## `Welfare Spending % GDP`      -0.02211333
## `Gini Coefficient`            42.01666458
## `Housing Affordability Index`  .         
## `Mortgage as a % of Income`    .         
## `Price to Income Ratio`        .         
## `Corruption Perception`        .         
## `GDP Per Capita`               .         
## `% of World GDP`               .
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{relaxed\_lasso\_pov }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Health Care Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Wealth Share Top 1\%}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Welfare Spending \% GDP}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Gini Coefficient}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Mortgage as a \% of Income}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Price to Income Ratio}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Corruption Perception}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{data=}\NormalTok{c.data.notest2)}

\FunctionTok{summary}\NormalTok{(relaxed\_lasso\_pov)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `Poverty Rate` ~ `Social Mobility Index` + `Health Care Index` + 
##     `Education Index` + `Wealth Share Top 1%` + `Welfare Spending % GDP` + 
##     `Gini Coefficient` + `Mortgage as a % of Income` + `Price to Income Ratio` + 
##     `Corruption Perception` + `GDP Per Capita`, data = c.data.notest2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.2505 -0.6836  0.1162  0.8940  1.8849 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(>|t|)  
## (Intercept)                 35.10479   23.52937   1.492   0.1666  
## `Social Mobility Index`     -0.45334    0.24123  -1.879   0.0896 .
## `Health Care Index`          0.16038    0.10683   1.501   0.1642  
## `Education Index`           -5.44548   10.39532  -0.524   0.6118  
## `Wealth Share Top 1%`       18.85440   17.37906   1.085   0.3034  
## `Welfare Spending % GDP`    -0.31410    0.10996  -2.856   0.0171 *
## `Gini Coefficient`           9.02454   22.08243   0.409   0.6914  
## `Mortgage as a % of Income` -9.38991    4.28869  -2.189   0.0534 .
## `Price to Income Ratio`      0.51710    0.39324   1.315   0.2179  
## `Corruption Perception`      0.11599    0.10018   1.158   0.2739  
## `GDP Per Capita`            -0.02654    0.02725  -0.974   0.3531  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.654 on 10 degrees of freedom
##   (56 observations deleted due to missingness)
## Multiple R-squared:  0.8705, Adjusted R-squared:  0.7409 
## F-statistic:  6.72 on 10 and 10 DF,  p-value: 0.002917
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm\_pov }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}}\NormalTok{ . }\SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Health Care Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Health Expenditure Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{\% of World GDP}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}}\SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Wealth Share Top 1\%}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Mortgage as a \% of Income}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Welfare Spending \% GDP}\StringTok{\textasciigrave{}}\NormalTok{,c.data.notest2)}
\FunctionTok{summary}\NormalTok{(lm\_pov)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `Poverty Rate` ~ . - `Health Care Index` - `Health Expenditure Index` - 
##     `% of World GDP` - `Education Index` - `Affordable Housing` - 
##     `Wealth Share Top 1%` - `Mortgage as a % of Income` - `Welfare Spending % GDP`, 
##     data = c.data.notest2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4967 -1.0231  0.1821  0.9145  2.5642 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(>|t|)   
## (Intercept)                   -10.47289   13.78870  -0.760  0.46014   
## `Social Mobility Index`        -0.52307    0.17219  -3.038  0.00886 **
## `Gini Coefficient`             35.34125   14.80075   2.388  0.03160 * 
## `Housing Affordability Index`   8.14839    2.66890   3.053  0.00860 **
## `Price to Income Ratio`         1.49718    0.49456   3.027  0.00905 **
## `Corruption Perception`         0.37124    0.09017   4.117  0.00105 **
## `GDP Per Capita`               -0.06167    0.01972  -3.128  0.00741 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.783 on 14 degrees of freedom
##   (56 observations deleted due to missingness)
## Multiple R-squared:  0.7891, Adjusted R-squared:  0.6987 
## F-statistic:  8.73 on 6 and 14 DF,  p-value: 0.0004447
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# GDP}
\NormalTok{predictorsgdp }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.notest }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{predictorsgdp }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data=}\NormalTok{predictorsgdp)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}

\NormalTok{lasso\_gdp }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(predictorsgdp, no\_na.notest}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{alpha=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Option grouped=FALSE enforced in cv.glmnet, since < 3 observations per
## fold
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(lasso\_gdp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 14 x 1 sparse Matrix of class "dgCMatrix"
##                                       s1
## (Intercept)                   31.2690739
## `Social Mobility Index`        .        
## `Health Care Index`            .        
## `Health Expenditure Index`     .        
## `Education Index`              .        
## `Wealth Share Top 1%`          .        
## `Welfare Spending % GDP`       .        
## `Gini Coefficient`             .        
## `Housing Affordability Index`  .        
## `Mortgage as a % of Income`    .        
## `Price to Income Ratio`        .        
## `Corruption Perception`        0.3046682
## `% of World GDP`               .        
## `Poverty Rate`                 .
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{relaxed\_lasso\_gdp }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Corruption Perception}\StringTok{\textasciigrave{}}\NormalTok{, c.data.notest2)}
\FunctionTok{summary}\NormalTok{(relaxed\_lasso\_gdp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `GDP Per Capita` ~ `Education Index` + `Corruption Perception`, 
##     data = c.data.notest2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -29.094  -7.565  -1.855   4.822  70.924 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(>|t|)    
## (Intercept)             -40.1500    10.5981  -3.788 0.000315 ***
## `Education Index`         8.9748    18.5899   0.483 0.630737    
## `Corruption Perception`   1.1387     0.1477   7.710 5.75e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 15.4 on 71 degrees of freedom
##   (3 observations deleted due to missingness)
## Multiple R-squared:  0.6539, Adjusted R-squared:  0.6441 
## F-statistic: 67.06 on 2 and 71 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm\_GDP }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}}\NormalTok{ . }\SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Mortgage as a \% of Income}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{\% of World GDP}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Welfare Spending \% GDP}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Health Expenditure Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Affordable Housing}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}} \StringTok{\textasciigrave{}}\AttributeTok{Wealth Share Top 1\%}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{, c.data.notest2)}
\FunctionTok{summary}\NormalTok{(lm\_GDP)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `GDP Per Capita` ~ . - `Mortgage as a % of Income` - 
##     `% of World GDP` - `Social Mobility Index` - `Education Index` - 
##     `Welfare Spending % GDP` - `Health Expenditure Index` - `Affordable Housing` - 
##     `Wealth Share Top 1%` - `Poverty Rate`, data = c.data.notest2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -30.494  -3.016   1.322   6.346  43.736 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                   -299.2435   101.4423  -2.950  0.00994 ** 
## `Health Care Index`             -2.2466     0.6216  -3.614  0.00255 ** 
## `Gini Coefficient`             228.5897   101.8484   2.244  0.04032 *  
## `Housing Affordability Index`   66.5781    27.9270   2.384  0.03077 *  
## `Price to Income Ratio`         13.1341     5.2951   2.480  0.02547 *  
## `Corruption Perception`          2.9813     0.5553   5.369 7.82e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 17.22 on 15 degrees of freedom
##   (56 observations deleted due to missingness)
## Multiple R-squared:  0.7249, Adjusted R-squared:  0.6332 
## F-statistic: 7.904 on 5 and 15 DF,  p-value: 0.0008027
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm\_GDP2 }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Gini Coefficient}\StringTok{\textasciigrave{}}\NormalTok{, c.data.notest2)}
\FunctionTok{summary}\NormalTok{(lm\_GDP2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = `GDP Per Capita` ~ `Social Mobility Index` + `Education Index` + 
##     `Poverty Rate` + `Gini Coefficient`, data = c.data.notest2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -25.629 -13.681  -6.072   7.922  51.606 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(>|t|)   
## (Intercept)             -424.640    144.140  -2.946  0.00904 **
## `Social Mobility Index`    3.414      1.014   3.367  0.00366 **
## `Education Index`        128.496    106.764   1.204  0.24525   
## `Poverty Rate`            -3.121      2.077  -1.503  0.15128   
## `Gini Coefficient`       437.821    169.460   2.584  0.01932 * 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 22.74 on 17 degrees of freedom
##   (55 observations deleted due to missingness)
## Multiple R-squared:  0.4875, Adjusted R-squared:  0.367 
## F-statistic: 4.043 on 4 and 17 DF,  p-value: 0.01752
\end{verbatim}

\section{testing log GDP}\label{testing-log-gdp}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{c.data.notestlogGDP }\OtherTok{\textless{}{-}}\NormalTok{ c.data.notest2 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{logGDPPC =} \FunctionTok{log}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)}


\NormalTok{c.data.testlogGDP }\OtherTok{\textless{}{-}}\NormalTok{ c.data.test2 }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{logGDPPC =} \FunctionTok{log}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(c.data.notestlogGDP, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\StringTok{\textasciigrave{}}\AttributeTok{Corruption Perception}\StringTok{\textasciigrave{}}\NormalTok{, }\AttributeTok{y=}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{+}
\FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se=}\NormalTok{F)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `geom_smooth()` using method = 'loess' and formula = 'y ~ x'
\end{verbatim}

\begin{verbatim}
## Warning: Removed 2 rows containing non-finite outside the scale range
## (`stat_smooth()`).
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm\_log\_GDP }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Housing Affordability Index}\StringTok{\textasciigrave{}}\SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Health Care Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Health Expenditure Index}\StringTok{\textasciigrave{}}\NormalTok{, c.data.notestlogGDP)}
\FunctionTok{summary}\NormalTok{(lm\_log\_GDP)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = logGDPPC ~ `Housing Affordability Index` + `Education Index` + 
##     `Health Care Index` + `Health Expenditure Index`, data = c.data.notestlogGDP)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.24203 -0.28210 -0.02298  0.22283  1.55326 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                   -0.82231    0.97986  -0.839 0.404794    
## `Housing Affordability Index`  0.31346    0.09123   3.436 0.001098 ** 
## `Education Index`              4.72848    0.63284   7.472 4.72e-10 ***
## `Health Care Index`           -0.36584    0.11049  -3.311 0.001603 ** 
## `Health Expenditure Index`     0.19894    0.05619   3.541 0.000795 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.4911 on 58 degrees of freedom
##   (14 observations deleted due to missingness)
## Multiple R-squared:  0.7816, Adjusted R-squared:  0.7665 
## F-statistic: 51.89 on 4 and 58 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.gdp.lm.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lm\_log\_GDP, c.data.testlogGDP)}
\NormalTok{log.gdp.lm.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.testlogGDP}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ log.gdp.lm.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\FunctionTok{exp}\NormalTok{(log.gdp.lm.mse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.061746
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predictorsgdp }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.notest }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)}
\NormalTok{predictorsgdp }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data=}\NormalTok{predictorsgdp)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}

\NormalTok{no\_na.notestloggdp }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.notest }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{logGDPPC =} \FunctionTok{log}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)}

\NormalTok{no\_na.testloggdp }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.test }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{logGDPPC =} \FunctionTok{log}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)}

\NormalTok{lasso\_log\_gdp }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(predictorsgdp, no\_na.notestloggdp}\SpecialCharTok{$}\NormalTok{logGDPPC, }\AttributeTok{alpha=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Option grouped=FALSE enforced in cv.glmnet, since < 3 observations per
## fold
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(lasso\_gdp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 14 x 1 sparse Matrix of class "dgCMatrix"
##                                       s1
## (Intercept)                   31.2690739
## `Social Mobility Index`        .        
## `Health Care Index`            .        
## `Health Expenditure Index`     .        
## `Education Index`              .        
## `Wealth Share Top 1%`          .        
## `Welfare Spending % GDP`       .        
## `Gini Coefficient`             .        
## `Housing Affordability Index`  .        
## `Mortgage as a % of Income`    .        
## `Price to Income Ratio`        .        
## `Corruption Perception`        0.3046682
## `% of World GDP`               .        
## `Poverty Rate`                 .
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.gdp.lasso.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lasso\_log\_gdp, }\FunctionTok{model.matrix}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{.,}\AttributeTok{data =}\NormalTok{ no\_na.testloggdp)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]) }

\NormalTok{log.gdp.lasso.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.testlogGDP}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ log.gdp.lasso.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{log.gdp.lasso.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2161223
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{relaxed\_lasso\_log\_gdp }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}} \SpecialCharTok{\textasciitilde{}} \StringTok{\textasciigrave{}}\AttributeTok{Corruption Perception}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Education Index}\StringTok{\textasciigrave{}} \SpecialCharTok{+} \StringTok{\textasciigrave{}}\AttributeTok{Welfare Spending \% GDP}\StringTok{\textasciigrave{}}\NormalTok{, no\_na.testloggdp)}
\NormalTok{log.gdp.relaxed.lm.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(relaxed\_lasso\_log\_gdp, c.data.testlogGDP)}
\NormalTok{log.gdp.relaxed.lm.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.testlogGDP}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ log.gdp.relaxed.lm.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{log.gdp.relaxed.lm.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.0442472
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.gdp.fit\_tree }\OtherTok{\textless{}{-}} \FunctionTok{rpart}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data =}\NormalTok{ no\_na.notestloggdp, }\AttributeTok{control=}\FunctionTok{rpart.control}\NormalTok{(}\AttributeTok{minsplit=}\DecValTok{2}\NormalTok{, }\AttributeTok{cp=}\FloatTok{0.01}\NormalTok{))}
\FunctionTok{rpart.plot}\NormalTok{(log.gdp.fit\_tree)}
\end{Highlighting}
\end{Shaded}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-8-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.gdp.tree.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(log.gdp.fit\_tree, no\_na.testloggdp)}
\NormalTok{log.gdp.tree.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((no\_na.testloggdp}\SpecialCharTok{$}\NormalTok{logGDPPC }\SpecialCharTok{{-}}\NormalTok{ log.gdp.tree.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{log.gdp.tree.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5841309
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{new\_names2 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}SMI\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}HCI\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}HEI\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}EI\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}WST1\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}WSGDP\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}GINI\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}HAI\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}MPI\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}PIR\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}CP\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}PWGDP\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}PR\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}GDPPC\textquotesingle{}}\NormalTok{ )}

\NormalTok{no\_na.notestloggdp2 }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.notestloggdp }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{new\_names2) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{logGDPPC =}\NormalTok{ GDPPC)}

\NormalTok{no\_na.testloggdp2 }\OtherTok{\textless{}{-}}\NormalTok{ no\_na.testloggdp }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename\_with}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{new\_names2) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{logGDPPC =}\NormalTok{ GDPPC)}


\NormalTok{log.gdp.error.p }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{16} \CommentTok{\# set up a vector of length 16}
\ControlFlowTok{for}\NormalTok{ (p }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{16}\NormalTok{) }\CommentTok{\# repeat the following code inside \{ \} 16 times}
\NormalTok{\{}
\NormalTok{forest.log.gdp }\OtherTok{\textless{}{-}} \FunctionTok{randomForest}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{logGDPPC}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{., no\_na.notestloggdp2, }\AttributeTok{mtry=}\NormalTok{p, }\AttributeTok{ntree=}\DecValTok{250}\NormalTok{)}
\NormalTok{log.gdp.error.p[p] }\OtherTok{\textless{}{-}}\NormalTok{ forest.log.gdp}\SpecialCharTok{$}\NormalTok{mse[}\DecValTok{250}\NormalTok{] }\CommentTok{\# collecting oob mse based on 250 trees}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
\end{verbatim}

\begin{verbatim}
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{16}\NormalTok{, log.gdp.error.p, }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\FloatTok{6.5}\NormalTok{,}\FloatTok{6.6}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-8-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rf\_log\_gdp }\OtherTok{\textless{}{-}} \FunctionTok{randomForest}\NormalTok{(logGDPPC}\SpecialCharTok{\textasciitilde{}}\NormalTok{ . ,}\AttributeTok{data=}\NormalTok{no\_na.notestloggdp2, }\AttributeTok{mtry=}\DecValTok{13}\NormalTok{, }\AttributeTok{ntree=}\DecValTok{100}\NormalTok{)}
\NormalTok{rf\_log\_gdp.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(rf\_log\_gdp, no\_na.testloggdp2)}
\NormalTok{rf\_log\_gdp.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((no\_na.testloggdp2}\SpecialCharTok{$}\NormalTok{logGDPPC }\SpecialCharTok{{-}}\NormalTok{ rf\_log\_gdp.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{rf\_log\_gdp.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2193094
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.gdp.mse }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(log.gdp.lm.mse, log.gdp.lasso.mse, log.gdp.relaxed.lm.mse, log.gdp.tree.mse, rf\_log\_gdp.mse)}
\NormalTok{log.gdp.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   log.gdp.lm.mse log.gdp.lasso.mse log.gdp.relaxed.lm.mse log.gdp.tree.mse
## 1     0.05991502         0.2161223              0.0442472        0.5841309
##   rf_log_gdp.mse
## 1      0.2193094
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1000} \SpecialCharTok{*} \FunctionTok{exp}\NormalTok{(log.gdp.mse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   log.gdp.lm.mse log.gdp.lasso.mse log.gdp.relaxed.lm.mse log.gdp.tree.mse
## 1       1061.746          1241.254               1045.241         1793.432
##   rf_log_gdp.mse
## 1       1245.217
\end{verbatim}

\subsection{TREE}\label{tree}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-9-1.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-9-2.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-9-3.pdf}

\subsection{RANDOM FORESTS}\label{random-forests}

\begin{verbatim}
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{verbatim}
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-10-2.pdf}

\begin{verbatim}
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
## Warning in randomForest.default(m, y, ...): invalid mtry: reset to within valid
## range
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-10-3.pdf}

\subsection{TRAINING ERROR:}\label{training-error}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#predicted values}
\CommentTok{\#lm}
\NormalTok{smi.lm.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lm\_smi, c.data.test2) }
\NormalTok{gdp.lm.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lm\_GDP, c.data.test2) }
\NormalTok{pov.lm.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lm\_pov, c.data.test2) }
\NormalTok{gdp.lm.p2 }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lm\_GDP2, c.data.test2)}
\CommentTok{\#lasso}
\NormalTok{smi.lasso.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lasso\_smi, }\FunctionTok{model.matrix}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{.,}\AttributeTok{data =}\NormalTok{ no\_na.test)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]) }\CommentTok{\# done}
\NormalTok{gdp.lasso.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lasso\_gdp, }\FunctionTok{model.matrix}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{.,}\AttributeTok{data =}\NormalTok{ no\_na.test)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]) }\CommentTok{\# done but acc model doesnt exist}
\NormalTok{pov.lasso.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lasso\_pov, }\FunctionTok{model.matrix}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\SpecialCharTok{\textasciitilde{}}\NormalTok{.,}\AttributeTok{data =}\NormalTok{ no\_na.test)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]) }\CommentTok{\# done}
\CommentTok{\#relaxed lasso}
\NormalTok{smi.rlasso.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(relaxed\_lasso\_smi, c.data.test2) }\CommentTok{\# done}
\NormalTok{gdp.rlasso.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(relaxed\_lasso\_gdp, c.data.test2) }\CommentTok{\# done but acc model doesnt exist}
\NormalTok{pov.rlasso.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(relaxed\_lasso\_pov, c.data.test2) }\CommentTok{\# done}
\CommentTok{\#trees}
\NormalTok{smi.tree.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(smi.fit\_tree1, c.data.test2) }\CommentTok{\# done}
\NormalTok{gdp.tree.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(gdp.fit\_tree1, c.data.test2) }\CommentTok{\# done}
\NormalTok{pov.tree.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(pov.fit\_tree1, c.data.test2) }\CommentTok{\# done}
\CommentTok{\#random forests}
\NormalTok{smi.rf.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(rf\_smi, no\_na.test2) }\CommentTok{\# done but acc model doesnt exist}
\NormalTok{gdp.rf.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(rf\_gdp, no\_na.test2) }\CommentTok{\# done but acc model doesnt exist}
\NormalTok{pov.rf.p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(rf\_pov, no\_na.test2) }\CommentTok{\# done but acc model doesnt exist}

\CommentTok{\#mse values}
\CommentTok{\#lm}
\NormalTok{smi.lm.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ smi.lm.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\CommentTok{\# done}
\NormalTok{gdp.lm.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ gdp.lm.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\CommentTok{\# done}
\NormalTok{pov.lm.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ pov.lm.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\CommentTok{\# done}
\NormalTok{gdp.lm.mse2 }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ gdp.lm.p2)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\#lasso}
\NormalTok{smi.lasso.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ smi.lasso.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{gdp.lasso.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ gdp.lasso.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{pov.lasso.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ pov.lasso.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\CommentTok{\#relaxed lasso}
\NormalTok{smi.rlasso.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ smi.rlasso.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{gdp.rlasso.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ gdp.rlasso.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{pov.rlasso.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ pov.rlasso.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\CommentTok{\#trees}
\NormalTok{smi.tree.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ smi.tree.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{gdp.tree.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ gdp.tree.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{pov.tree.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ pov.tree.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\CommentTok{\#random forests}
\NormalTok{smi.rf.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ smi.rf.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{gdp.rf.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ gdp.rf.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }
\NormalTok{pov.rf.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}} \SpecialCharTok{{-}}\NormalTok{ pov.rf.p)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }


\CommentTok{\#dataframe mse by smi gdp and pov}
\NormalTok{smi.mse}\OtherTok{\textless{}{-}}\FunctionTok{data.frame}\NormalTok{(smi.lm.mse, smi.lasso.mse, smi.rlasso.mse, smi.tree.mse, smi.rf.mse)}
\NormalTok{gdp.mse}\OtherTok{\textless{}{-}}\FunctionTok{data.frame}\NormalTok{(gdp.lm.mse, gdp.lasso.mse, gdp.rlasso.mse, gdp.tree.mse, gdp.rf.mse)}
\NormalTok{pov.mse}\OtherTok{\textless{}{-}}\FunctionTok{data.frame}\NormalTok{(pov.lm.mse, pov.lasso.mse, pov.rlasso.mse, pov.tree.mse, pov.rf.mse)}

\NormalTok{smi.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   smi.lm.mse smi.lasso.mse smi.rlasso.mse smi.tree.mse smi.rf.mse
## 1   3.152519      6.625323       4.103939      25.9785   7.356278
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gdp.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   gdp.lm.mse gdp.lasso.mse gdp.rlasso.mse gdp.tree.mse gdp.rf.mse
## 1   387.1845      446.1761       196.6012     2736.049   1592.186
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pov.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   pov.lm.mse pov.lasso.mse pov.rlasso.mse pov.tree.mse pov.rf.mse
## 1   1.583777      8.559722       2.482727     20.57525   4001.297
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{log.gdp.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   log.gdp.lm.mse log.gdp.lasso.mse log.gdp.relaxed.lm.mse log.gdp.tree.mse
## 1     0.05991502         0.2161223              0.0442472        0.5841309
##   rf_log_gdp.mse
## 1      0.2193094
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{exp}\NormalTok{(log.gdp.mse) }\SpecialCharTok{*} \DecValTok{1000}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   log.gdp.lm.mse log.gdp.lasso.mse log.gdp.relaxed.lm.mse log.gdp.tree.mse
## 1       1061.746          1241.254               1045.241         1793.432
##   rf_log_gdp.mse
## 1       1245.217
\end{verbatim}

\subsection{Ensemble}\label{ensemble}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ensemble prediction and mse by smi gdp and pov}
\CommentTok{\#smi}
\NormalTok{smi.ensemble.pred }\OtherTok{\textless{}{-}}\NormalTok{ (smi.lm.p}\SpecialCharTok{+}\NormalTok{smi.lasso.p}\SpecialCharTok{+}\NormalTok{smi.rlasso.p}\SpecialCharTok{+}\NormalTok{smi.tree.p}\SpecialCharTok{+}\NormalTok{smi.rf.p)}\SpecialCharTok{/}\DecValTok{5}
\NormalTok{smi.ensemble.mse}\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((smi.ensemble.pred}\SpecialCharTok{{-}}\NormalTok{c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Social Mobility Index}\StringTok{\textasciigrave{}}\NormalTok{)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\#gdp}
\NormalTok{gdp.ensemble.pred }\OtherTok{\textless{}{-}}\NormalTok{ (gdp.lm.p}\SpecialCharTok{+}\NormalTok{gdp.lasso.p}\SpecialCharTok{+}\NormalTok{gdp.rlasso.p}\SpecialCharTok{+}\NormalTok{gdp.tree.p}\SpecialCharTok{+}\NormalTok{gdp.rf.p)}\SpecialCharTok{/}\DecValTok{5}
\NormalTok{gdp.ensemble.mse}\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((gdp.ensemble.pred}\SpecialCharTok{{-}}\NormalTok{c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{GDP Per Capita}\StringTok{\textasciigrave{}}\NormalTok{)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\#pov}
\NormalTok{pov.ensemble.pred }\OtherTok{\textless{}{-}}\NormalTok{ (pov.lm.p}\SpecialCharTok{+}\NormalTok{pov.lasso.p}\SpecialCharTok{+}\NormalTok{pov.rlasso.p}\SpecialCharTok{+}\NormalTok{pov.tree.p}\SpecialCharTok{+}\NormalTok{pov.rf.p)}\SpecialCharTok{/}\DecValTok{5}
\NormalTok{pov.ensemble.mse}\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((pov.ensemble.pred}\SpecialCharTok{{-}}\NormalTok{c.data.test2}\SpecialCharTok{$}\StringTok{\textasciigrave{}}\AttributeTok{Poverty Rate}\StringTok{\textasciigrave{}}\NormalTok{)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}


\NormalTok{smi.ensemble.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5.461461
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gdp.ensemble.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 649.5356
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pov.ensemble.mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 156.2514
\end{verbatim}

\section{PREDICTION}\label{prediction}

\textbf{CHOSEN MODELS} Social Mobility Index: Linear Model

\begin{verbatim}
## 
## Call:
## lm(formula = `Social Mobility Index` ~ `Education Index` + `Wealth Share Top 1%` + 
##     `Welfare Spending % GDP` + `Corruption Perception` + `Health Care Index` + 
##     `Housing Affordability Index`, data = refined_country_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.8843 -2.0893  0.5847  1.4304  5.0994 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                    31.12478    9.67961   3.215  0.00327 ** 
## `Education Index`              16.78308    9.48034   1.770  0.08757 .  
## `Wealth Share Top 1%`         -70.33036   14.78501  -4.757 5.39e-05 ***
## `Welfare Spending % GDP`        0.20041    0.11620   1.725  0.09562 .  
## `Corruption Perception`         0.38582    0.06572   5.870 2.60e-06 ***
## `Health Care Index`             0.04596    0.07982   0.576  0.56935    
## `Housing Affordability Index`   1.55567    1.38638   1.122  0.27135    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 3.116 on 28 degrees of freedom
##   (47 observations deleted due to missingness)
## Multiple R-squared:  0.9061, Adjusted R-squared:  0.886 
## F-statistic: 45.04 on 6 and 28 DF,  p-value: 4.124e-13
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-13-1.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-13-2.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-13-3.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-13-4.pdf}

Poverty Rate: Linear Model

\begin{verbatim}
## 
## Call:
## lm(formula = `Poverty Rate` ~ . - `Health Care Index` - `Health Expenditure Index` - 
##     `% of World GDP` - `Education Index` - `Affordable Housing` - 
##     `Wealth Share Top 1%` - `Mortgage as a % of Income` - `Welfare Spending % GDP`, 
##     data = c.data.notest2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4967 -1.0231  0.1821  0.9145  2.5642 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(>|t|)   
## (Intercept)                   -10.47289   13.78870  -0.760  0.46014   
## `Social Mobility Index`        -0.52307    0.17219  -3.038  0.00886 **
## `Gini Coefficient`             35.34125   14.80075   2.388  0.03160 * 
## `Housing Affordability Index`   8.14839    2.66890   3.053  0.00860 **
## `Price to Income Ratio`         1.49718    0.49456   3.027  0.00905 **
## `Corruption Perception`         0.37124    0.09017   4.117  0.00105 **
## `GDP Per Capita`               -0.06167    0.01972  -3.128  0.00741 **
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.783 on 14 degrees of freedom
##   (56 observations deleted due to missingness)
## Multiple R-squared:  0.7891, Adjusted R-squared:  0.6987 
## F-statistic:  8.73 on 6 and 14 DF,  p-value: 0.0004447
\end{verbatim}

\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-14-1.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-14-2.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-14-3.pdf}
\includegraphics{WDS-Project_files/figure-latex/unnamed-chunk-14-4.pdf}

GDP Per Capita:

america\_base \textless- refined\_country\_data{[}27,{]}

america1 \textless- america\_base \%\textgreater\%
mutate(\texttt{Education\ Index})

```

\end{document}
